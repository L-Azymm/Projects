# ğŸ›¡ï¸ Broken Access Control (OWASP Top 10 - A01:2021)

<br><br>

---
---

## âœ¨ Overview

This project demonstrates [**Broken Access Control**](https://owasp.org/Top10/A01_2021-Broken_Access_Control/), where users can perform actions outside their intended permissions.

It highlights two main types of attacks:

- [**IDOR (Insecure Direct Object Reference)**](https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html)

- [**Forced Browsing**](https://owasp.org/www-community/attacks/Forced_browsing)

Understanding these issues is important to build safer and more secure web applications. ğŸ”’

<br><br>

---
---

## Checkpoints ğŸš©

- [ğŸ›¡ï¸ Broken Access Control (OWASP Top 10 - A01:2021)](#ï¸-broken-access-control-owasp-top-10---a012021)
  - [âœ¨ Overview](#-overview)
  - [Checkpoints ğŸš©](#checkpoints-)
  - [ğŸ–¥ï¸ Lab Setup](#ï¸-lab-setup)
    - [ğŸ› ï¸ Step-by-Step Setup Instructions](#ï¸-step-by-step-setup-instructions)
  - [ğŸš¨ Vulnerability Demonstration](#-vulnerability-demonstration)
    - [ğŸ•µï¸â€â™‚ï¸ IDOR (Insecure Direct Object Reference)](#ï¸ï¸-idor-insecure-direct-object-reference)
    - [ğŸšª Forced Browsing](#-forced-browsing)
  - [ğŸ›¡ï¸ Countermeasure](#ï¸-countermeasure)

## ğŸ–¥ï¸ Lab Setup

| ğŸ–¥ï¸ Tools               | âš™ï¸ Example               |
| ---------------------- | ------------------------ |
| Web application        | Simple PHP/MySQL App      |
| Browser                | Chrome, Firefox           |
| Burp Suite (optional)  | For request interception  |
| Localhost environment  | XAMPP / WAMP / LAMP       |

<br><br>

---

### ğŸ› ï¸ Step-by-Step Setup Instructions

1. **Install XAMPP / WAMP / LAMP**  
   - Download and install XAMPP (or similar) on your machine.

2. **Start Apache and MySQL**  
   - Open your XAMPP control panel.
   - Click **Start** on both **Apache** and **MySQL**.

3. **Place the Application Files**  
   - Copy the PHP project folder into the `htdocs` directory (for XAMPP users).
   - Example: `C:\xampp\htdocs\app\`

4. **Import the Database**  
   - Open **phpMyAdmin**
  
      ```bash
      http://localhost/phpmyadmin/
      ```

   - Create a new database (e.g., `demo`).
   - Import the provided [.sql](Assets/users.sql) file into the database.

      ```sql
      USE app;

      CREATE TABLE users (
      id INT AUTO_INCREMENT PRIMARY KEY,
      username VARCHAR(50) NOT NULL,
      password VARCHAR(255) NOT NULL,
      role VARCHAR(20) DEFAULT 'user'  -- user or admin
      );

      INSERT INTO users (username, password, role) VALUES
      ('userA', 'password123', 'user'),
      ('userB', 'password123', 'user'),
      ('admin', 'admin123', 'admin');
      ```

5. **Creating PHPs Files**

   - Import the given php file into your coding enviroment
  
     - [login.php](Assets/PHP/admin.php)
     - [profile.php](Assets/PHP/profile.php)
     - [admin.php](Assets/PHP/admin.php)
     - [logout.php](Assets/PHP/logout.php)

6. **Run the Web Application**  
   - Open your browser and go to:
  
   ```bash
   http://localhost/demo/
   ```

7. **Login Credentials**  
   - Use the provided test users (example: `userA/password123`).

---
---

## ğŸš¨ Vulnerability Demonstration

### ğŸ•µï¸â€â™‚ï¸ IDOR (Insecure Direct Object Reference)

1. Login as **User A** using your test account.
2. Go to your profile page. Example URL:

   ```bash
   http://localhost/app/profile.php?id=1
   ```

3. In the browser address bar, **manually change** the `id` value to another userâ€™s ID, for example:

   ```bash
   http://localhost/app/profile.php?id=2
   ```

4. ğŸ¯ **Result:**  
   You are now able to view **User B's** profile information **without permission**.

> â— This shows that the application does not verify whether you are authorized to access the requested resource.

<br>

---

### ğŸšª Forced Browsing

1. Stay logged in as a normal user (non-admin).
2. In your browser, manually enter the following URL:

   ```bash
   http://localhost/app/admin.php
   ```

3. ğŸ¯ **Result:**  
   Even though you are not an admin, the admin page **still opens**.  
   No authentication or authorization checks are in place to block unauthorized users.

> â— This proves the app does not properly protect sensitive admin functionality.

<br><br>

---
---

## ğŸ›¡ï¸ Countermeasure

To fix Broken Access Control issues:

- âœ… Always verify permissions server-side for every sensitive action.
- âœ… Use Role-Based Access Control (RBAC) to manage user roles properly.
- âœ… Apply the Principle of Least Privilege â€” users should only have access they absolutely need.
- âœ… Block direct URL access unless authorized.
- âœ… Never rely on client-side checks (like hiding buttons) for security!

---
